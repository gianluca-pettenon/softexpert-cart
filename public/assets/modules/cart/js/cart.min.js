$(document).ready(function(){var t=$("#tblCart").DataTable({ajax:{url:"/product",type:"POST",dataType:"json",dataSrc:function(t){return t&&t.data?t.data:{}},error:function(t,a,n){console.log(t),Message.Toast({message:n,class:"danger"})},complete:function(t,a){}},columns:[{title:"PRODUTO",data:"name"},{title:"PRE&Ccedil;O",data:"price",render:function(t,a,n){return"R$"+t}},{title:"PERC. TIPO PRODUTO",data:"tax",render:function(t,a,n){return t+"%"}},{title:"QUANTIDADE",data:"amount",render:function(t,a,n){return"<input type='number' class='form-control form-control-sm text-center cart-amount' style='width: 75px' autocomplete='off' min='0' max='10' step='1' value='0'>"}}],columnDefs:[{targets:[2],className:"text-center"}],processing:!1,bInfo:!1,ordering:!1,responsive:!0,drawCallback:function(a){$(".cart-amount").on("change",function(){t.row($(this).closest("tr")).data().amount=$(this).val()})},language:Language.DataTable});$("#tblCart tbody").on("change",".cart-amount",function(){var a=t.row($(this).closest("tr")).data(),n=$("#"+a.id+"-product");if(!n.length){var e="";e+="<div id='"+a.id+"-product'>",e+="<b>Produto</b>: "+a.name+"<br>",e+="<b>Quantidade</b>: <span class='amount'>"+a.amount+"</span><br>",e+="<b>Pre&ccedil;o</b>: <span class='price'>"+a.price+"</span><br>",e+="<b>Imposto</b>: <span class='tax'>"+(parseFloat(a.price)*parseFloat(a.tax)/100).toFixed(2)+"</span><br><br>",e+="<b>Total</b>: <span class='productTotal'>"+a.price+"</span><br>",e+="<hr>",e+="</div>"}n.find("span.amount").html(a.amount).end(),0==a.amount?n.remove():1==a.amount?n.find("span.productTotal").html(a.price).end():a.amount>1&&n.find("span.productTotal").html((parseFloat(a.price)*parseFloat(a.amount)).toFixed(2)).end(),$("#cartProducts").append(e);var o=0;$("span.productTotal").each(function(){var t=parseFloat($(this).text());o+=t}),$("#cartTotal").html("R$"+o.toFixed(2));var r=0;$("span.tax").each(function(){var t=parseFloat($(this).text());r+=t}),$("#cartTaxTotal").html("R$"+r.toFixed(2))})});